<template>
	<view class="container">
		<!--
		æ³¨æ„ï¼šè¿™æ˜¯ App æ‰€ç”¨é¡µé¢ï¼Œè¯·å‹¿å¼•å…¥å¾®ä¿¡å°ç¨‹åºæˆ–æµè§ˆå™¨è¿è¡Œï¼Œæœ€å¥½è¿è¡Œåœ¨çœŸæœº
		 
		1. new_index.nvueã€index.nvueè¿™ä¸¤ä¸ªæ˜¯Appé¡µé¢
		 
		2. index.nvue - é¡µé¢é¢„åŠ è½½ä½¿ç”¨ - åœ¨çº¿é¢„åŠ è½½æ–¹æ¡ˆ
		 
		3. å¦å¤–ï¼šdata.js æ˜¯ä¸Šä¸€ç‰ˆæœ¬ç•™ä¸‹çš„å‡æ•°æ®ï¼Œè¿™ä¸€ç‰ˆæ”¹æˆäº† URL è¯·æ±‚äº†ï¼ˆå¦‚ä¸éœ€è¦å¯ä»¥åˆ é™¤ï¼Œä¹Ÿå¯ä½œä¸ºåç«¯è¯·æ±‚å‚è€ƒï¼‰
		 
		4. è¯·å„ä½å¤§ç¥å¤šå¤šç•™æ‰‹ï¼Œæˆ‘å·²ç»æŠŠè¯·æ±‚å†…å­˜å¼€åˆ°æœ€å¤§äº†
		 
		5. è§†é¢‘ id åˆ‡è®°æ˜¯å­—ç¬¦ä¸²ç±»å‹
		 
		6. è¿™é‡Œä»… App ç«¯å¼•å…¥äº† App ç«¯ä¸“ç”¨è¯„è®ºï¼Œå°ç¨‹åº ã€H5 å¼•å…¥çš„æ—¶å€™ å¯ä»¥ä½œä¸ºå‚è€ƒ
		
		ã€
			Appã€å°ç¨‹åºã€H5è¯„è®ºè¯·å‚è€ƒæ’ä»¶ï¼šhttps://ext.dcloud.net.cn/plugin?id=7875
		ã€‘
		 -->
		<!-- <u-tabbar v-model="current" icon-size="54" :border-top="false" inactive-color="#999" active-color="#3077FB" :list="tabbarList"></u-tabbar> -->
    <!-- åº•éƒ¨tab -->
   <!-- <view id="bottom-tab" ref="bottomTab" class="reset-nvue flex col-center row-around" style="height: 100rpx; position: fixed;z-index: 99999;width: 750rpx;bottom: 0;padding: 0 62rpx;">
      <view class="text-center" v-for="(item,index) in tabbarList" :key="index" @click="handleChangeTabbar(item.pagePath)">
      <view class="reset-nvue flex col-center row-center">
        <image style="width:54rpx;height: 54rpx;display: inline-block;margin: 0 auto;" :src="index == 1 ? item.selectedIconPath : item.iconPath" mode="aspectFit"></image>
      </view>
      <text class="text-center text-666" :class="index == 1 ? 'main-color' : ''" style="font-size: 20rpx;">
        {{item.text}}
      </text>
     </view>
    </view> -->
    <view class="" style="background: #fff;" :style="`height:${statusBarHeight}px`">
    </view>
    <!-- é¡¶éƒ¨tab -->
   <view class="video-navbar reset-nvue" :style="`width:${boxStyle.width};padding-top:${40 + (topBarHeight * 2)}rpx`">
      <view class="" style="position: relative;">
        <image class="viode-top-icon" src="@/static/video/add-video-icon.png" mode="heightFix" @click="handleNavbarImg(0)"></image>
<!--        <view class="select-video-type" :class="[showSelectVideoType ? 'select-show-height' : '']">
          <text class="select-video-text p-b-10" style="border-bottom: 1px solid #ccc;" @click="handleAddVideo(0)">ç›¸å†Œ</text>
          <text class="select-video-text p-t-10" @click="handleAddVideo(1)">å½•åˆ¶</text>
        </view> -->
      </view>
      <view class="flex reset-nvue">
        <view class="col-center" @click="handleChangeTab(0)">
          <text class="navbar-title" :class="[navbarTabIdx == 0 ? 'active-bold' : '']">å‘ç°</text>
          <view :class="[navbarTabIdx == 0 ? 'bar-active' : 'not-active']"></view>
        </view>
       <view class="col-center m-l-60" @click="handleChangeTab(1)">
          <text class="navbar-title active-bold">å…³æ³¨</text>
          <view :class="[navbarTabIdx == 1 ? 'bar-active' : 'not-active']"></view>
        </view>
      </view>
      <image class="viode-top-icon" src="@/static/video/search-video-icon.png" mode="heightFix" @click="handleNavbarImg(1)"></image>
    </view>
<!-- 		<view @click="tolistVideo" style="position: fixed; margin-top: 100upx; right: 40upx;">
			<text style="padding: 10upx; padding-left: 40upx; padding-right: 40upx; border-radius: 20upx; background-color: #F8F8F8; font-size: 14px;">H5/å°ç¨‹åº</text>
		</view>
		<view @click="autoPlay" style="position: fixed; margin-top: 100upx; left: 40upx;">
			<text style="padding: 10upx; padding-left: 40upx; padding-right: 40upx; border-radius: 20upx; background-color: #F8F8F8; color: #007AFF; font-weight: bold; font-size: 14px;">{{autoplayText}}</text>
		</view>
		<view @click="previewVideo" style="position: fixed; margin-top: 200upx; right: 40upx;">
			<text style="padding: 10upx; padding-left: 40upx; padding-right: 40upx; border-radius: 20upx; background-color: #F8F8F8; font-size: 14px;">Appç«¯-é¢„è§ˆè§†é¢‘ç•Œé¢</text>
		</view>
		<view @click="wxh5Video" style="position: fixed; margin-top: 300upx; right: 40upx;">
			<text style="padding: 10upx; padding-left: 40upx; padding-right: 40upx; border-radius: 20upx; background-color: #F8F8F8; font-size: 14px;">å¾®ä¿¡/H5ç«¯-é¢„è§ˆè§†é¢‘ç•Œé¢</text>
		</view> -->
		<image v-if="isShowAixin" src="@/static/img/index/aixining.png" :style="'position: fixed; margin-left: '+ aixinLeft +'px; margin-top: '+ aixinTop +'px; width: 70px; height: 65px; transform: rotate('+ Rotate +'deg);'"></image>
		<view :style="'width: '+ windowWidth +'px; height: '+ boxStyle.height +'px;'">
			<!-- 
			 1.è¿™é‡Œçš„ swiper ä¸æ˜¯ç”¨æ¥æ§åˆ¶è§†é¢‘æ»‘åŠ¨çš„ï¼Œè€Œæ˜¯ç”¨æ¥æ§åˆ¶å·¦å³æ»‘åŠ¨çš„ï¼Œå¦‚æœä¸éœ€è¦çš„å¯ä»¥æ”¹æˆ view
			 
			 2.ä¸ºäº† è§†é¢‘æ— é™åŠ è½½ï¼Œå·²ç»æŠŠ 21 è¡Œçš„ appear å»æ‰äº†ï¼ŒåŠ ä¸Šäº† loadmore æ–¹æ³•ï¼ˆç¬¬10è¡Œï¼‰
			 
			 3.ç”±äºæ–¹æ³•æ¯”è¾ƒå¤šï¼Œå¯ä»¥é‡‡å–ä¸‹é¢çš„æ–¹å¼æŸ¥çœ‹ä»£ç ï¼š
			 ï¼ˆ1ï¼‰Macï¼šæŒ‰ä½ option é”®ï¼Œç„¶åç‚¹å‡»æ–¹æ³•åï¼Œå³å¯è·³è½¬åˆ°æ–¹æ³•
			 ï¼ˆ2ï¼‰windowsï¼šæŒ‰ä½ Alt é”®ï¼Œç„¶åé¼ æ ‡å·¦å‡»ï¼Œå³å¯è·³è½¬åˆ°æ–¹æ³•
			 -->
			<list @loadmore="getData" @scroll="scrolls" :loadmoreoffset="wHeight*3" :show-scrollbar="false" ref="listBox" :pagingEnabled="true" :scrollable="true">
				<!-- åˆ·æ–°æ¨¡å— -->
				<refresh class="refresh" @refresh="onrefresh" @pullingdown="onpullingdown" :display="refreshing ? 'show' : 'hide'">
					<loading style="background-color: #FFFFFF;">
						<image src="@/static/img/index/logins.gif" :style="'width: 80upx; height: 40upx; margin-top: 80upx; margin-bottom: 30upx; margin-left: '+ (windowWidth - 200) +'px;'"></image>
					</loading>
				</refresh>
				
				<!-- å¾ªç¯æ•°æ® -->
				<!-- <cell v-for="(item,i) in dataList" :key="i"> -->
				<cell v-for="(item,i) in videoNewList" :key="i">
					<!-- ç”¨divæŠŠè§†é¢‘æ¨¡ç»„å¥—èµ·æ¥ -->
					<div :style="'width: '+ windowWidth +'px; height: '+ boxStyle.height +'px;'" @disappear="stop()">
						<view class="root">
							<!-- 
							å…·ä½“è§†é¢‘å‚æ•°å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£
							è¯´æ˜ï¼š
							1.v-ifå¾ˆå…³é”®ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘ dom å…ƒç´ ã€è¿™æ ·æ‰ä¸ä¼šåŠ è½½è§†é¢‘å¤šäº†é—ªé€€ã€‘ï¼Œ
								è¿™é‡Œ Math.abs(k-i)<=5 ä¹Ÿå°±æ˜¯å¾€ä¸Šé¢„åŠ è½½ 5 ä¸ªè§†é¢‘ï¼Œå¾€ä¸‹é¢„åŠ è½½ 5 
								ä¸ªè§†é¢‘è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†è®©è§†é¢‘èƒ½å¤Ÿæå‰åŠ è½½ä½†æ˜¯ä¸æ’­æ”¾ï¼Œåœ¨çœŸæ­£æ»‘åˆ°ä½
								ç½®çš„æ—¶å€™æ’­æ”¾è§†é¢‘ã€‚
								ã€2.0.1å°±æ˜¯  1  Math.abs(k-i)<=1ï¼šè¯·å‹¿ä¿®æ”¹ï¼Œè®°ä½ï¼Œè¦ä¸ç„¶ä¼šæå‰æ’­æ”¾å¾ˆå¤šè§†é¢‘ã€‘
								
							2.è¦æ³¨æ„ @play="playIngs" é‡Œé¢çš„ playIngs æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åªæ˜¯åœ¨è§†é¢‘æ’­æ”¾çš„æ—¶å€™
								èµ·æ•ˆæœï¼Œæˆ‘ä»¬æ§åˆ¶è§†é¢‘æ’­æ”¾ä¸æ˜¯ç”¨è¿™ä¸ªçš„ã€‚è¿™ä¸ªçš„ä¸»è¦ä½œç”¨æ˜¯ç»™è§†é¢‘å°é¢çš„ã€‚æˆ‘ä»¬å…ˆç”¨
								ä¸‹é¢çš„è§†é¢‘å°é¢ç›–ä½è§†é¢‘ï¼Œç­‰åˆ°è§†é¢‘æ’­æ”¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è¦æ€¥ç€ç›´æ¥æ’­æ”¾ï¼Œè€Œæ˜¯å»¶è¿Ÿä¸€ä¸‹ä¸‹ï¼Œ
								300-600mså·¦å³ã€‚å› ä¸ºè§†é¢‘æ’­æ”¾éœ€è¦ä¸€ç‚¹ç‚¹æ—¶é—´ï¼Œè¿™ç‚¹æ—¶é—´é‡Œä¼šé»‘å±ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ç”¨
								ä¸‹é¢çš„å°é¢ç›–ä½ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸ä¼šæœ‰ä»é»‘å±åˆ°æœ‰ç”»é¢çš„æ„Ÿè§‰äº†ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°è§†é¢‘å¤ªå¤§ï¼Œç¼“å†²
								æ—¶é—´å¤ªé•¿ï¼Œè¿˜æ˜¯ä¼šå‡ºç°çŸ­æš‚çš„é»‘å±ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¸ä¼šæœ‰é»‘å±çš„ï¼ˆè¿™æ ·ç›–ä½çš„è¯ï¼‰ã€‚
								
								ã€æ›´æ–°è®°å½•ï¼š2.0ç‰ˆã€‘å·²ç»è§£å†³äº†è§†é¢‘é»‘å±é—®é¢˜ï¼Œå’ŒåŠ è½½é€Ÿåº¦æ…¢çš„æƒ…å†µï¼Œå¦‚æœè¿˜æ˜¯å‡ºç°äº†é»‘å±ï¼Œ
								æ„å‘³ç€æ­¤æ—¶æ‰‹æ»‘åŠ¨çš„é€Ÿåº¦ï¼Œå·²ç»è¶…è¿‡äº†è§†é¢‘åŠ è½½çš„é€Ÿåº¦ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå»ºè®®ä¿®æ”¹ preloadNumber 
								å˜é‡ï¼Œå½“å®ƒçš„å€¼å¤§ä¸€ç‚¹çš„æ—¶å€™å°±ä¼šæå‰åŠ è½½è§†é¢‘ï¼Œè¿™æ ·ç”¨æˆ·åœ¨æ»‘åˆ°è§†é¢‘çš„æ—¶å€™å°±ä¸ä¼šæœ‰åœé¡¿æ„Ÿäº†
								ã€æ³¨æ„ã€‘ï¼šè€ç”¨æˆ·åœ¨ video ä¸­å¢åŠ å’Œä¿®æ”¹ 
								ï¼ˆ1ï¼‰:muted="!item.playIng"ï¼Œ
								ï¼ˆ2ï¼‰@timeupdate="timeupdate($event,i)"
								ï¼ˆ3ï¼‰æŠŠ 199 è¡Œæ³¨é‡Šäº†ï¼Œ
								ï¼ˆ4ï¼‰:id="item._id"ï¼Œ
								ï¼ˆ5ï¼‰ä¿®æ”¹ï¼šuni.createVideoContext(this.dataList[this.k]._id + '' + this.k,this) ä¸º
									uni.createVideoContext(this.dataList[this.k]._id,this)
								ï¼ˆ6ï¼‰åœ¨ timeupdate æ–¹æ³•é‡ŒåŠ å…¥ï¼Œif(index == this.k){æŠŠé‡Œé¢çš„åŠ ä¸€ä¸ªæ€»çš„åˆ¤æ–­}
							3.å…¶ä»–çš„ä¸‹é¢æœ‰è¯¦è§£
							 -->
							<video
								v-if="Math.abs(k-i)<=1"
								:ref="'item'+i"
								:id="item._id"
								:loop="true"
								:src="item.video_image_format"
								:muted="item.isplay"
								@play="playIngs(i)"	
								:enable-progress-gesture="false"
								:page-gesture="false"
								:controls="false"
								:show-loading="false"
                :play-strategy="2"
								:show-fullscreen-btn="false"
								:show-center-play-btn="false"
								:style="boxStyle"
								:object-fit="object_fit"
								@timeupdate="timeupdate($event,i)"
							></video>
							<!-- è¿™é‡Œæ˜¯å°é¢ -->
							<image
                v-if="!item.playIng"
								:src="item.video_cover_image_format" 
								:mode="mode"
								:style="'width: '+ windowWidth +'px; height: '+ (wHeight - deleteHeight) +'px; position: absolute;'"
							></image>
							<!-- 
							mode: å›¾ç‰‡è£å‰ªã€ç¼©æ”¾çš„æ¨¡å¼
							mode æœ‰ 14 ç§æ¨¡å¼ï¼Œå…¶ä¸­ 5 ç§æ˜¯ç¼©æ”¾æ¨¡å¼ï¼Œ9 ç§æ˜¯è£å‰ªæ¨¡å¼ã€‚
							https://uniapp.dcloud.io/component/image
							 -->
						</view>
						<!-- ç›´æ¥ç”¨ view å°±è¡Œäº†ï¼Œä¸€æ ·æ˜¯å¯ä»¥è¦†ç›–åŸç”Ÿç»„ä»¶çš„ -->
						<!-- è¿™ä¸ªæ˜¯æš‚åœæ—¶å‡ºç°çš„å›¾æ ‡   @touchstart="touchstartHover"-->
						<view class="videoHover" @click="tapVideoHover(item.state,$event)" :style="boxStyle">
							<image v-if="item.state=='pause'" class="playState" src="@/static/img/index/play.png"></image>
						</view>
						<view class="userInfo">
							<!-- 1.å¤´åƒ -->
              <view class="user-avatar-body">
                <image v-if="item.isShowProgressBarTime == false && item.user" @click="handleAhtuorInfo(item.user_id)" class="userAvatar" :src="item.user.avatar_format" mode="aspectFill"></image>
                <text class="add-user-icon" @click="handleAddUser(item)" v-if="!item.is_follow">+</text>
              </view>
							<!-- 2.ç‚¹èµ -->
							<view v-if="item.isShowProgressBarTime == false" @click="cLike(item);" style="opacity: 0.9; margin-top: 17px;">
								<image v-if="item.is_like" src="@/static/video/xin.png" style="width: 30px; height: 30px; position: absolute; right: 10px;"></image>
								<image v-if="!item.is_like" src="@/static/video/xin-2.png" style="width: 30px; height: 30px; position: absolute; right: 10px;"></image>
								<text style="color: #FFFFFF; font-size: 14px; text-align: center; margin-top: 30px; font-weight: bold;" :class="{'likeNumActive':item.is_like}">{{item.like}}</text>
							</view>
							<!-- 3.è¯„è®º -->
							<view v-if="item.isShowProgressBarTime == false" class="comment" @click="toComment(i)" style="opacity: 0.9; margin-top: 17px;">
								<image src="@/static/img/index/comment-icon.png" style="width: 25px; height: 25px; position: absolute; right: 12px;"></image>
								<text style="color: #FFFFFF; font-size: 14px; font-weight: bold; text-align: center; margin-top: 30px;">{{item.comment}}</text>
							</view>
							<!-- æ”¶è— -->
							<view v-if="item.isShowProgressBarTime == false" class="comment" @click="handleFavorite(item)" style="opacity: 0.9; margin-top: 17px;">
								<image v-if="!item.is_favorite" src="/static/video/collect-video-icon.png" style="width: 25px; height: 25px; position: absolute; right: 12px;"></image>
								<image v-else src="/static/video/collect-video-icon-active.png" style="width: 25px; height: 25px; position: absolute; right: 12px;"></image>
								<text style="color: #FFFFFF; font-size: 14px; font-weight: bold; text-align: center; margin-top: 30px;">{{item.favorite}}</text>
							</view>
							<!-- 4.åˆ†äº« -->
							<view v-if="item.isShowProgressBarTime == false" @click="handleSharePopup(item)" style="opacity: 0.9; margin-top: 17px;">
								<image src="@/static/img/index/share-fill.png" style="width: 30px; height: 30px; position: absolute; right: 10px;"></image>
								<text style="color: #FFFFFF; font-size: 14px; text-align: center; font-weight: bold; margin-top: 30px;">{{item.transmit}}</text>
							</view>
						</view>
						<!-- æœ€åº•ä¸‹çš„æ–‡å­—éƒ¨åˆ† -->
						<view class="content" v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == false">
							<text class="userName" :style="'width: '+ (windowWidth - 90) +'px;'" v-if="item.user">@{{item.user.nickname}}</text>
              <!-- i={{i}} -->
							<text class="words" :style="'width: '+ (windowWidth - 90) +'px;'">{{item.video_title}}</text><!-- k={{k}} -->
						</view>
						<!-- 1.è§†é¢‘é¢„è§ˆæ—¶çš„å›¾ç‰‡ï¼Œcurrenttimesï¼šå°±æ˜¯è·å–å½“å‰æ»‘å—çš„æ—¶é—´ç‚¹ï¼Œå¦‚æœä¸éœ€è¦ï¼Œå¯ä»¥æ³¨é‡Šæ‰ -->
						<!-- 2.å¦‚æœä½¿ç”¨ä¸‹é¢çš„è§†é¢‘é¢„è§ˆçš„è¯è¦æ³¨æ„çš„æ˜¯è§†é¢‘é“¾æ¥æœ€å¥½æ˜¯é˜¿é‡Œäº‘ä¸Šçš„ï¼Œå› ä¸º
								https://xxxxxxxxx.mp4?x-oss-process=video/snapshot,t_1000,f_jpg
								è¿™ä¸ªæ˜¯é˜¿é‡Œäº‘çš„ä¸œè¥¿ï¼Œè‡³äºå…¶ä»–çš„è§†é¢‘æˆªå¸§æˆ‘è¿˜æ²¡æœ‰è¯•è¿‡ã€‚
								-->
						<!-- 3.é˜¿é‡Œäº‘è§†é¢‘æˆªå¸§åœ°å€ï¼šhttps://help.aliyun.com/document_detail/64555.html -->
            
<!-- 						<image
						v-if="item.isShowimage == true"
							:src="item.src+'?x-oss-process=video/snapshot,t_'+ currenttimes +'000,f_jpg'" 
							mode="aspectFill"
							:style="'width: 120upx; height: 160upx; border-radius: 10upx; position: absolute; bottom: '+ (ProgressBarBottom + 160) +'upx; left: '+ (currentPositions - 15) +'px;'"
						></image> -->
					</div>
				</cell>
			</list>
			<!-- 1.æ³¨æ„ï¼šè¿›åº¦æ¡è¿™ç±»æ‹–æ‹½çš„ä¸œè¥¿ä¸èƒ½æ”¾è¿›block\cellè¿™äº›å¾ªç¯ä½“ä¸­çš„ï¼Œè¦ä¸ç„¶touchmoveæ–¹æ³•ä¼šæ•æ‰æœ‰è¯¯ -->
			<view v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == true" :style="'position: absolute; bottom: '+ (ProgressBarBottom + this.windowWidth*0.2)/2 +'px; left: '+ (windowWidth*2 - this.windowWidth*1.35)/2 +'px;'">
				<text style="font-size: 22px; font-weight: bold; color: #F1F1F1;">{{changeTime}} / {{videoTimes}}</text>
			</view>
			<!-- è¿™é‡Œå°±æ˜¯è¿›åº¦æ¡äº†ï¼šçº¯æ‰‹å·¥è¿›åº¦æ¡ï¼Œè°ƒæ•´ä½ç½®çš„è¯å°±æŠŠä»–ä»¬çš„ bottom æ”¹æˆä¸€ä¸‹å°±è¡Œäº† -->
			<view v-if="isDragging == false" @touchmove="touchmove" @touchend="touchend" @touchstart="touchstart" style="position: absolute; bottom: 0; left: 0;">
				<!-- 1.è¿™ä¸€æ­¥å¿…é¡»åŠ ï¼Œä¸ºäº†é€‚é…ä½ç«¯æœºå‹ -->
				<text :style="'width: '+ windowWidth +'px; opacity: 0;'">.</text>
				<!-- 2.è¿™æ˜¯æœªåŠ è½½çš„æ—¶çš„å³è¾¹çš„ç°è‰²éƒ¨åˆ† -->
				<view :style="'width: '+ windowWidth +'px; height: 4upx; background-color: #C8C7CC; position: absolute; bottom: '+ ProgressBarBottom +'upx; opacity: '+ ProgressBarOpacity +';'"></view>
				<!-- 3.è¿™é‡Œæˆ‘é‡‡ç”¨çš„åˆ†ç¦»å¼åŠæ³•ï¼šå°±æ˜¯è®©æ»‘åŠ¨æ ·å¼å’Œä¸æ»‘åŠ¨çš„æ ·å¼åˆ†å¼€ï¼Œè¿™æ ·ç›¸äº’ä¸å¹²æ‰°ï¼Œå¯ä»¥é¿å…è¿›åº¦æ¡é—ªåŠ¨çš„é—®é¢˜ -->
				<!-- 4.æ³¨æ„ï¼šisShowProgressBarTime åŠ å…¥äº†è¿”å›æ•°æ®ä¸­ -->
				<view v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == false" :style="'width: '+ (currentPosition) +'px; height: 4upx; background-color: #FFFFFF; position: absolute; bottom: '+ ProgressBarBottom +'upx; left: 0; opacity: '+ (ProgressBarOpacity - 0.1) +';'"></view>
				<view v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == true" :style="'width: '+ (currentPositions) +'px; height: 8upx; background-color: #FFFFFF; position: absolute; bottom: '+ ProgressBarBottom +'upx; left: 0; opacity: '+ (ProgressBarOpacity + 0.05) +';'"></view>
				<view v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == false" :style="'width: 4px; height: 4px; background-color: #FFFFFF; border-radius: 10px; position: absolute; bottom: '+ (ProgressBarBottom - 2) +'upx; left: '+ (currentPosition) +'px; opacity: '+ ProgressBarOpacity +';'"></view>
				<view v-if="videoNewList.length !== 0 && videoNewList[k].isShowProgressBarTime == true" :style="'width: '+ dotWidth +'px; height: '+ dotWidth +'px; background-color: #FFFFFF; border-radius: 10px; position: absolute; bottom: '+ (ProgressBarBottom - 5) +'upx; left: '+ (currentPositions - 5) +'px; opacity: '+ ProgressBarOpacity +';'"></view>
			</view>
		</view>
		<!--
		
		è¯·å‰å¾€ douyin-scrollview.nvue æ–‡ä»¶æŸ¥çœ‹
		
		å·²ç»å…¨éƒ¨æ³¨é‡Š
		
		 è¿™é‡Œå°±æ˜¯å¼•å…¥è¯„è®ºæ’ä»¶
		 
		 
		 -->
		<uni-popup type="bottom" ref="pinglun" @touchmove.stop.prevent="moveHandle">
			<view :style="'width: '+ windowWidth +'px; height: '+ (boxStyle.height/heightNum) +'px; background-color: #242424; border-top-left-radius: 10px; border-top-right-radius: 10px;'">
				<!-- 
				 æ³¨æ„ï¼š
				 deleteIOSHeight
				 deleteAndroidHeight
				 è¿™ä¸¤ä¸ªå‚æ•°ç”¨äºæ§åˆ¶è¯„è®ºç­‰çš„é«˜åº¦
				 -->
				<douyin-scrollview
				:Width="windowWidth"
				:Height="(boxStyle.height/1.23)"
				:deleteIOSHeight="36"
				:deleteAndroidHeight="15"
        :isNotIndex="true"
				@closeScrollview="closeScrollview"
				></douyin-scrollview>
			</view>
		</uni-popup>
    <!-- åˆ†äº«å¼¹çª— -->
    <uni-popup type="bottom" ref="share" @touchmove.stop.prevent="handleCloseSharePopup">
      <view class="share-bottom" style="height: 160px;background: #fff;">
        <view class="" style="height: 20rpx;"></view>
        <view class="flex reset-nvue col-center row-between p-l-40 p-r-40">
          <image style="width: 40rpx;height: 40rpx;visibility: hidden;" src="/static/video/close-icon.png" mode=""></image>
        	<text class="font-30">åˆ†äº«åˆ°</text>
          <image style="width: 40rpx;height: 40rpx;" src="/static/video/gray-close-icon.png" mode="" @click="handleCloseSharePopup()"></image>
        </view>
        <view class="" style="height: 46rpx;"></view>
        <view class="flex reset-nvue col-center row-between m-b-30 share-row">
        	<view class="share-item" v-for="(item,index) in shareList.slice(0,4)" :key="index" @click="handleShareItem(index)">
        		<view class="share-img">
        			<image style="width: 70rpx;height: 70rpx;" :src="`/static/index/share/share-icon${item.icon}.png`" mode="aspectFit"></u-image>
        		</view>
        		<text class="text-center font-24 m-t-22">{{item.title}}</text>
        	</view>
        </view>
        <view class="" style="height: 20rpx;"></view>
      </view>
    </uni-popup>
    
    <uni-popup type="bottom" ref="video"  @touchmove.stop.prevent="handleCloseVideoPopup">
      <view class="upload-video">
        <view class="upload-item" @click="handleAddVideo(0)">ç›¸å†Œ</view>
        <view class="upload-item upload-border" @click="handleAddVideo(1)">å½•åˆ¶</view>
        <view class="upload-item" @click="handleCloseVideoPopup">å–æ¶ˆ</view>
      </view>
    </uni-popup>
		<!-- <u-tabbar v-model="current" icon-size="54" :border-top="false" inactive-color="#999" active-color="#3077FB" :list="tabbarList"></u-tabbar> -->
	</view>
</template>
<script>
  let app = getApp();
	// import userList from './data.js'//è¿™ä¸ªæ˜¯å‡æ•°æ®
	/*
	å¼•å…¥è¯„è®ºç»„ä»¶
	*/ 
	import douyinScrollview from '@/components/douyin-scrollview/douyin-scrollview.nvue'
	// åº•éƒ¨tab
	import {tabbar} from '@/utils/tabBar.js';
  import config from '@/utils/config.js';
  import * as api from '@/utils/api.js';
  import AES from '@/common/aes.js'
	export default {
    data() {
			return {
				current:0,
				tabbarList:tabbar,
        navbarTabList:['å‘ç°','å…³æ³¨'],
        navbarTabIdx:0, //é¡¶éƒ¨tabä¸‹æ ‡
        showSelectVideoType:false, //æ˜¾ç¤ºæ˜¯æ·»åŠ è§†é¢‘æ˜¯ä»ç›¸å†Œé€‰æ‹©è¿˜æ˜¯å½•åˆ¶
        location:{},  //å®šä½ä¿¡æ¯
        userInfo:{},  //ç”¨æˆ·ä¿¡æ¯
        listQuery:{
          page:1,
          limit:15,
        },
        videoNewList:[],
        shareList:[
        	{icon:1,title:'å¾®ä¿¡'},
        	{icon:2,title:'æœ‹å‹åœˆ'},
        	{icon:3,title:'ä¸‹è½½'},
        	{icon:4,title:'ä¸¾æŠ¥'},
        ],
        shareItem:{},
        topBarHeight:0, //é¡¶éƒ¨åˆ˜æµ·é«˜åº¦
        myFollowNum:0, //æˆ‘çš„å…³æ³¨äººæ•°ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦åˆ‡æ¢é¡¶éƒ¨tabå…³æ³¨
        statusBarHeight:20, //é¡¶éƒ¨çŠ¶æ€æ é«˜åº¦
        isRrshing:false, 
        
				//ä¸‹é¢æ‰“ğŸŒŸå·çš„æ˜¯å¿…é¡»è¦çš„åŸºç¡€å­—æ®µ
				//ä¸‹é¢æ‰“ğŸ’—å·çš„æ˜¯æ‹¥æœ‰æ»‘åŠ¨æ¡çš„å¿…é¡»å­—æ®µ
				dataList:[],//ç”¨äºæ•°æ®å¾ªç¯çš„åˆ—è¡¨ğŸŒŸğŸ’—
				wHeight:0,//è·å–çš„å±å¹•é«˜åº¦ğŸŒŸğŸ’—
				boxStyle:{//è§†é¢‘ï¼Œå›¾ç‰‡å°é¢æ ·å¼ğŸŒŸğŸ’—
					'height': 0,
					'width': 0,
				},
				k:0,//é»˜è®¤ä¸º0ğŸŒŸğŸ’—
				playIngIds:[],//æ­£åœ¨æ’­æ”¾çš„è§†é¢‘idåˆ—é˜Ÿï¼Œåˆ—é˜Ÿç”¨äºå¤„ç†æ»‘åŠ¨è¿‡å¿«å¯¼è‡´çš„è·³é¢‘é—®é¢˜ğŸŒŸğŸ’—
				ready:false,//å¯å¿½ç•¥
				isDragging: false,//falseä»£è¡¨åœæ­¢æ»‘åŠ¨ğŸŒŸğŸ’—
				refreshing: true,//ç”¨äºä¸‹æ‹‰åˆ·æ–°ğŸŒŸğŸ’—
				windowWidth: 0,//è·å–å±å¹•å®½åº¦ğŸŒŸğŸ’—
				windowHeight: 0,
				dex: [0,0],//ç”¨äºåˆ¤æ–­æ˜¯ä¸Šæ»‘è¿˜æ˜¯ä¸‹æ»‘ï¼Œç¬¬ä¸€ä¸ªå­˜æ—§å€¼ï¼Œç¬¬äºŒä¸ªå­˜æ–°å€¼ã€ç›®å‰åœ¨1.0.7å·²ç»åºŸå¼ƒã€‘
				currents: 0,//ç”¨äºå·¦å³æ»‘åŠ¨ï¼Œ0ä»£è¡¨è§†é¢‘ç•Œé¢ï¼Œ1ä»£è¡¨å³æ»‘ç•Œé¢ğŸŒŸğŸ’—
				platform: '',//ç”¨äºè·å–æ“ä½œç³»ç»Ÿï¼šiosã€androidğŸŒŸğŸ’—
				playIng: false,//ç”¨äºè§†é¢‘åˆå§‹åŒ–æ—¶æ˜¯å¦æ’­æ”¾ï¼Œé»˜è®¤ä¸æ’­æ”¾ğŸŒŸğŸ’—
				videoTime: '',//è§†é¢‘æ€»æ—¶é•¿ï¼Œè¿™ä¸ªä¸»è¦ç”¨æ¥æˆªå–æ—¶é—´æ•°å€¼ğŸ’—
				videoTimes: '',//è§†é¢‘æ—¶é•¿ï¼Œç”¨è¿™ä¸ªæ¥è·å–æ—¶é—´å€¼ï¼Œä¾‹å¦‚ï¼š00:30è¿™ä¸ªæ—¶é—´å€¼ğŸ’—
				changeTime: '',//æ˜¾ç¤ºæ»‘åŠ¨è¿›åº¦æ¡æ—¶å˜åŒ–çš„æ—¶é—´ğŸ’—
				isShowimage: false,//æ˜¯å¦æ˜¾ç¤ºå°é¢ã€1.0.4å·²åºŸå¼ƒï¼Œä½†æ˜¯æ„æ€éœ€è¦è®°ä½ã€‘
				currenttimes: 0,//å½“å‰æ—¶é—´ğŸ’—
				isShowProgressBarTime: false,//æ˜¯å¦æ‹–åŠ¨è¿›åº¦æ¡ï¼Œå¦‚æœæ‹–åŠ¨ï¼ˆtrueï¼‰åˆ™æ˜¾ç¤ºè¿›åº¦æ¡æ—¶é—´ï¼Œå¦åˆ™ä¸æ˜¾ç¤ºï¼ˆfalseï¼‰ã€1.0.4å·²åºŸå¼ƒï¼Œä½†æ˜¯æ„æ€éœ€è¦è®°ä½ã€‘
				ProgressBarOpacity: 0.7,//è¿›åº¦æ¡ä¸æ‹–åŠ¨æ—¶çš„é»˜è®¤å€¼ï¼Œå°±æ˜¯é€æ˜çš„ğŸ’—
				dotWidth: 0,//æ’­æ”¾çš„å°åœ†ç‚¹ï¼Œé»˜è®¤æ²¡æœ‰ğŸ’—
				deleteHeight: 0,//æµ‹è¯•é«˜åº¦ğŸŒŸğŸ’—
				percent: 0,//ç™¾åˆ†å°æ•°ğŸ’—
				currentPosition: 0,//æ»‘å—å½“å‰ä½ç½®ğŸ’—//2.0å·²å¼ƒç”¨ï¼Œç°å·²ç”¨äºåç«¯å‚æ•°
				currentPositions: 0,//æ»‘å—å½“å‰ä½ç½®çš„å‰¯æœ¬ğŸ’—//2.0å·²å¼ƒç”¨ï¼Œç°å·²ç”¨äºåç«¯å‚æ•°
				newTime: 0,//è·Ÿæ‰‹æ»‘åŠ¨åçš„æœ€æ–°æ—¶é—´ğŸ’—
				timeNumber: 0,//ğŸŒŸğŸ’—
				ProgressBarBottom: 20,//è¿›åº¦æ¡ç¦»åº•éƒ¨çš„è·ç¦»ğŸ’—
				object_fit: 'contain',//è§†é¢‘æ ·å¼é»˜è®¤åŒ…å«ğŸŒŸğŸ’—
				mode: 'aspectFit',//å›¾ç‰‡å°é¢æ ·å¼ğŸŒŸğŸ’—
				timeout: "",//ğŸŒŸç”¨æ¥é˜»æ­¢ setTimeout()æ–¹æ³•
				voice: "",//ğŸŒŸç”¨æ¥é˜»æ­¢ setTimeout()æ–¹æ³•
				oldVideo: "",
				
				isAutoplay: false,//æ˜¯å¦å¼€å¯è‡ªåŠ¨æ’­æ”¾(é»˜è®¤ä¸å¼€å¯)
				autoplayText: "å¼€å¯è‡ªåŠ¨æ’­æ”¾",
				timers: "",
				
				// å¼•å…¥è¯„è®º - å‚æ•°
				heightNum: 1.18,
				
				// åŒå‡»ç‚¹èµå‚æ•°
				touchNum: 0,
				aixinLeft: 0,
				aixinTop: 0,
				isShowAixin: false,
				Rotate: 0
			}
        },
		components:{
			douyinScrollview,
		},
		watch:{
			k(k,old_k){//ç›‘å¬ k å€¼çš„å˜åŒ–ï¼Œå¯ä»¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ä¸æš‚åœ
				this.videoNewList[old_k].state = 'stop'//å¦‚æœæ˜¯è¢«æ»‘èµ°çš„è§†é¢‘ï¼Œå°±åœæ­¢æ’­æ”¾
				this.videoNewList[old_k].playIng = false//å¦‚æœè§†é¢‘æš‚åœï¼Œå°±åŠ è½½å°é¢
				this.videoNewList[old_k].isplay = true
				uni.createVideoContext(this.videoNewList[old_k]._id,this).play()
				clearTimeout(this.oldVideo)
				this.oldVideo = setTimeout(()=>{
					uni.createVideoContext(this.videoNewList[old_k]._id,this).seek(0)
					uni.createVideoContext(this.videoNewList[old_k]._id,this).pause()
					console.log('é¢„ç•™ç¬¬' + (old_k + 1) + 'ä¸ªè§†é¢‘ï¼š' + this.videoNewList[old_k]._id)
          // console.log('è§†é¢‘æ•°ç»„é•¿åº¦',this.videoNewList);
				},500)
				// 2.0ç‰ˆæœ¬å·²ç»å»æ‰äº†ä¸‹é¢è¿™ä¸€å¥ï¼Œè§†é¢‘ä¸ç”¨æš‚åœï¼Œåªéœ€è¦æŠŠå£°éŸ³ç¦æ­¢å°±è¡Œ
				// uni.createVideoContext(this.dataList[old_k]._id + '' + old_k,this).stop()//å¦‚æœè§†é¢‘æš‚åœï¼Œé‚£ä¹ˆæ—§è§†é¢‘åœæ­¢ï¼Œè¿™é‡Œçš„this.dataList[old_k]._id + '' + old_kï¼Œåé¢åŠ  old_k æ˜¯ä¸ºäº†æ¯ä¸€ä¸ªè§†é¢‘çš„ id å€¼ä¸åŒï¼Œè¿™æ ·å°±å¯ä»¥å¤§ç¨‹åº¦çš„é¿å…ä¸²éŸ³é—®é¢˜
				uni.createVideoContext(this.videoNewList[k]._id,this).play();
        // console.log('è§†é¢‘ä¸‹æ ‡',this.videoNewList[k].video_title);
        this.handleAddFoot(this.videoNewList[k].id);
				console.log('å·²ç»æš‚åœ --> ç¬¬' + (old_k + 1) + 'ä¸ªè§†é¢‘ï½')//æç¤º
				clearTimeout(this.voice)
				this.voice = setTimeout(()=>{
					this.videoNewList[k].isplay = false
				},300)
				setTimeout(()=>{
					this.videoNewList[k].playIng = true
				},850)
				//ã€2.0ç‰ˆæœ¬æ›´æ–°å†…å®¹ã€‘- start
				var p = k
				++p
				setTimeout(()=>{
					uni.createVideoContext(this.videoNewList[p]._id,this).play()
          this.handleAddViews(this.videoNewList[p].id);
				},20)
				clearTimeout(this.timeout)
				this.timeout = setTimeout(()=>{
					uni.createVideoContext(this.videoNewList[p]._id,this).seek(0)
					uni.createVideoContext(this.videoNewList[p]._id,this).pause()
					console.log('é¢„åŠ è½½ç¬¬' + (p + 1) + 'ä¸ªè§†é¢‘ï¼š' + this.videoNewList[p]._id)
				},1500)
				//ã€2.0ç‰ˆæœ¬æ›´æ–°å†…å®¹ã€‘- end
			}
		},
		onShow(){
      uni.showTabBar();
      let userInfo = uni.getStorageSync('userInfo');
      if(userInfo){
        this.userInfo = userInfo;
      }
      this.showSelectVideoType = false;
			if(this.videoNewList.length !== 0){
				this.videoNewList[this.k].state = 'play';
        console.log('å›æ¥äº†',this.videoNewList[this.k]);
				uni.createVideoContext(this.videoNewList[this.k]._id,this).play()
			}
      this.getMyFollowList();  //è·å–æˆ‘çš„å…³æ³¨
		},
		onHide(){
      this.$nextTick(()=>{
        uni.createVideoContext(this.videoNewList[this.k]._id,this).pause();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
        this.videoNewList[this.k].state = 'pause';//ç•Œé¢éšè—ä¹Ÿè¦åœæ­¢æ’­æ”¾è§†é¢‘
      })
		},
		onLoad(){
      let location = uni.getStorageSync('location');
      // #ifdef APP-PLUS
        this.topBarHeight = plus.navigator.getStatusbarHeight()
      // #endif
      if(location){
        this.location = location;
      }
			this.platform = uni.getSystemInfoSync().platform;
      this.statusBarHeight = uni.getSystemInfoSync().statusBarHeight;
			var model = uni.getSystemInfoSync().model
      // è‹¹æœæœºå‹
      if(this.platform == 'ios'){
        // iphone8ä»¥ä¸‹æœºå‹
        if(this.platform == 'ios' && (model === 'iPhone6' || model === 'iPhone 6' || model === 'iPhone6s' || model === 'iPhone 6s' || model === 'iPhone7' || model === 'iPhone 7' || model === 'iPhone8' || model === 'iPhone 8')){
        	this.deleteHeight = 50 + this.statusBarHeight;//æœ‰ tabbarçš„ ä¿®æ”¹è¿™é‡Œå¯ä»¥æ”¹å˜è§†é¢‘é«˜åº¦
        	 /*
        	 å¼•å…¥è¯„è®ºå‚æ•°
        	 */
        	
        	this.heightNum = 1.18
        } else { // iphone8ä»¥ä¸Šæœºå‹
          console.log('555555',model)
        	this.deleteHeight = 80 + this.statusBarHeight;//æœ‰ tabbarçš„ ä¿®æ”¹è¿™é‡Œå¯ä»¥æ”¹å˜è§†é¢‘é«˜åº¦
        	/*
        	å¼•å…¥è¯„è®ºå‚æ•°
        	*/
          console.log('ggggggg',this.deleteHeight)
        	this.heightNum = 1.27
        }
      }else{
        // å®‰å“æœºå‹
        this.deleteHeight = 50 + this.statusBarHeight;//æœ‰ tabbarçš„ ä¿®æ”¹è¿™é‡Œå¯ä»¥æ”¹å˜è§†é¢‘é«˜åº¦
         /*
         å¼•å…¥è¯„è®ºå‚æ•°
         */
        
        this.heightNum = 1.18
      }
      
			this.windowWidth = uni.getSystemInfoSync().screenWidth//è·å–å±å¹•å®½åº¦
			this.boxStyle.width = this.windowWidth + 'px'//ç»™å®½åº¦åŠ px
			this.wHeight = uni.getSystemInfoSync().screenHeight;//è·å–å±å¹•é«˜åº¦
			this.boxStyle.height = this.wHeight - this.deleteHeight;//æ”¹å˜è§†é¢‘é«˜åº¦
      this.get(this.navbarTabIdx)//è¿™ä¸€æ­¥ï¼ŒåŠ è½½è§†é¢‘æ•°æ®
		},
		onReady() {
      // uni.createSelectorQuery().in(this).select('#bottom-tab').boundingClientRect(result => {
        // this.deleteHeight = this.deleteHeight + (result.height);
        // this.windowWidth = uni.getSystemInfoSync().screenWidth//è·å–å±å¹•å®½åº¦
        // this.boxStyle.width = this.windowWidth + 'px'//ç»™å®½åº¦åŠ px
        // this.wHeight = uni.getSystemInfoSync().screenHeight;//è·å–å±å¹•é«˜åº¦
        // this.boxStyle.height = this.wHeight - this.deleteHeight;//æ”¹å˜è§†é¢‘é«˜åº¦
        // console.log('tabé«˜åº¦',this.deleteHeight);
      // }).exec()
		},
    methods: {
      // ç‚¹å‡»åˆ‡æ¢é¡¶éƒ¨tab
      handleChangeTab(index){
        // å¦‚æœç‚¹å‡»å…³æ³¨
        if(index == 1){
          if(this.myFollowNum == 0){
            uni.showToast({
              icon:'none',
              title:'æ‚¨è¿˜æ²¡æœ‰å…³æ³¨çš„ç”¨æˆ·'
            });
            return;
          }else{
            console.log('åˆ‡æ¢åˆ°äº†æ¨è',)
            this.listQuery.page = 1;
            this.videoNewList = [];
          }
        }else{
          this.listQuery.page = 1;
          this.videoNewList = [];
        }
        this.get(index);
        // if(index == 1){
        //   uni.navigateTo({
        //     url:'../mine/mineVideo/mineAttention/mineAttention'
        //   })
        // }
        
      },
      // ç‚¹å‡»é¡¶éƒ¨æ·»åŠ è§†é¢‘å›¾æ ‡æˆ–è€…æœç´¢å›¾æ ‡
      handleNavbarImg(type){
        switch(type){
          case 0: //æ·»åŠ è§†é¢‘
            // this.showSelectVideoType = !this.showSelectVideoType;
            this.$refs.video.open();
            break;
          case 1: //æœç´¢è§†é¢‘
            let url = './searchVideo/searchVideo';
            uni.navigateTo({
              url:url,
            })
            break;
        };
      },
      // è§†é¢‘å¢åŠ æµè§ˆé‡
      async handleAddViews(video_id){
				console.log('123',video_id)
        const res = await api.addVideoViews({video_id});
        if(res.code == 1){
        }
      },
      // ç‚¹å‡»ä»ç›¸å†Œé€‰æ‹©è¿˜æ˜¯å½•åˆ¶è§†é¢‘
      handleAddVideo(type){
        let sourceType = '';
        switch(type){
          case 0: //é€‰æ‹©ç›¸å†Œ
            sourceType = 'album';
            break;
          case 1: //å½•åˆ¶è§†é¢‘
            sourceType = 'camera';
            break;
        }
        let url = './addVideo/addVideo' + '?sourceType=' + sourceType;
        uni.navigateTo({
          url:url,
        })
      },
			autoPlay(){ 
				this.isAutoplay = !this.isAutoplay;
				if(!this.isAutoplay){
					this.autoplayText = "å¼€å¯è‡ªåŠ¨æ’­æ”¾"
					uni.showToast({
						title: "å…³é—­è‡ªåŠ¨æ’­æ”¾",
						icon: 'none',
						duration: 3000
					})
				} else {
					this.autoplayText = "å…³é—­è‡ªåŠ¨æ’­æ”¾"
					uni.showToast({
						title: "å¼€å¯è‡ªåŠ¨æ’­æ”¾",
						icon: 'none',
						duration: 3000
					})
				}
			},
			async getData(){
				// è¿™é‡Œå°±æ˜¯æ•°æ®åŠ è½½å®Œä»¥åå†å‘åç«¯å‘é€æ•°æ®çš„åœ°æ–¹
				// uni.request({
				// 	url: 'https://bdb24c6d-8c19-4f80-8e7e-c9c9f037f131.bspapp.com/video',
				// 	method: 'POST',
				// 	data:{
				// 		info: 'get_video'
				// 	},
				// 	success: (res) => {
				// 		var msg = res.data.data
				// 		for (let i = 0; i < msg.length; i++) {
				// 			this.videoNewList.push(msg[i])
				// 		}
				// 	}
				// })
        
        this.listQuery.page++;
        
        let data = {};
        let res = {};
        if(this.navbarTabIdx == 0){
          data = {
            ...this.listQuery,
            lng:this.location.lng,
            lat:this.location.lat,
          }
          const res = await api.videoList(data);
        }else if(this.navbarTabIdx == 1){
          data = {
            ...this.listQuery,
          };
          const res = await api.myFollowVideoList(data);
        }
        if(res.code == 1){
          if(res.data.data.length > 0){
            let videoList = res.data.data;
            videoList.map((item,index)=>{
              this.$set(item,'isplay',true); //æ˜¯å¦æ’­æ”¾éŸ³é¢‘
              this.$set(item,'isShowProgressBarTime',false); //æ˜¯å¦æ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
              this.$set(item,'state','pause'); //åˆå§‹çŠ¶æ€æ ‡å¿—ï¼ˆä¸æ”¹ï¼‰
              this.$set(item,'isShowimage',false); //æ˜¯å¦æ˜¾ç¤ºå°é¢ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
              this.$set(item,'playIng',false); //æ’­æ”¾ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
            })
            this.videoNewList = this.videoNewList.concat(videoList);
            // var msg = res.data.data
            // console.log(msg)
            // this.dataList = this.videoNewList;
            this.videoNewList[0].state = "play";
            setTimeout(()=>{
            	//è¿™é‡Œçš„å»¶è¿Ÿæ˜¯ä¸ºäº†é¿å…æ‰§è¡Œæ—¶é—´å¤ªå¿«è€Œç›´æ¥è·³è¿‡æ‰§è¡Œçš„ bug
            	uni.createVideoContext(this.videoNewList[0]._id,this).seek(0)
            	uni.createVideoContext(this.videoNewList[0]._id,this).play()
            },200)
            this.videoNewList[0].isplay = false
            setTimeout(()=>{
            	this.videoNewList[0].playIng = true
            },500)
            var p = 0
            setTimeout(()=>{
            	++p
            	uni.createVideoContext(this.videoNewList[p]._id,this).play()
            	setTimeout(()=>{
            		uni.createVideoContext(this.videoNewList[p]._id,this).seek(0)
            		uni.createVideoContext(this.videoNewList[p]._id,this).pause()
            		console.log('é¢„åŠ è½½ç¬¬' + (p + 1) + 'ä¸ªè§†é¢‘ï¼š' + this.videoNewList[p]._id)
            	},2000)
            },50)
          }
        }
			},
			touchstart(event){
				this.videoNewList[this.k].isShowimage = true //åˆšè§¦æ‘¸çš„æ—¶å€™å°±è¦æ˜¾ç¤ºé¢„è§ˆè§†é¢‘å›¾ç‰‡äº†
				this.videoNewList[this.k].isShowProgressBarTime = true //æ˜¾ç¤ºæ—¶é—´çº¿
				this.ProgressBarOpacity = 1 //è®©æ»‘å—æ˜¾ç¤ºèµ·æ¥æ›´æ˜æ˜¾ä¸€ç‚¹
				this.dotWidth = 10 //è®©ç‚¹æ˜¾ç¤ºèµ·æ¥æ›´æ˜æ˜¾ä¸€ç‚¹
			},
			touchend(){//å½“æ‰‹æ¾å¼€åï¼Œè·³åˆ°æœ€æ–°æ—¶é—´
				uni.createVideoContext(this.videoNewList[this.k]._id,this).seek(this.newTime)
				if(this.videoNewList[this.k].state == 'pause'){
					this.videoNewList[this.k].state = 'play'
					uni.createVideoContext(this.videoNewList[this.k]._id,this).play()
				}
				this.videoNewList[this.k].isShowProgressBarTime = false //è§¦æ‘¸ç»“æŸåï¼Œéšè—æ—¶é—´çº¿
				this.videoNewList[this.k].isShowimage = false //è§¦æ‘¸ç»“æŸåï¼Œéšè—æ—¶é—´é¢„è§ˆ
				this.ProgressBarOpacity = 0.5 //éšè—èµ·æ¥è¿›åº¦æ¡ï¼Œä¸é‚£ä¹ˆæ˜æ˜¾äº†
				this.dotWidth = 0 //éšè—èµ·æ¥è¿›åº¦æ¡ï¼Œä¸é‚£ä¹ˆæ˜æ˜¾äº†
			},
			touchmove(event){//å½“æ‰‹ç§»åŠ¨æ»‘å—æ—¶ï¼Œè®¡ç®—ä½ç½®ã€ç™¾åˆ†å°æ•°ã€æ–°çš„æ—¶é—´
				var msg = []
				if(this.videoTime !== ''){
					msg = this.videoTime.split(':')
				}
				var timeNumber = Number(msg[0])*60 + Number(msg[1])
				this.currentPositions = event.changedTouches[0].screenX
				this.percent = this.currentPositions / this.windowWidth
				this.newTime = this.percent*timeNumber 
				this.currenttimes = parseInt(this.newTime)
				let theTime = this.newTime
				let middle = 0;// åˆ†
				if(theTime > 60) {
					middle = parseInt(theTime/60);
					theTime = parseInt(theTime%60);	
				}
				this.changeTime = `${Math.round(middle)>9?Math.round(middle):'0'+Math.round(middle)}:${Math.round(theTime)>9?Math.round(theTime):'0'+Math.round(theTime)}`
			},
			timeupdate(event,index){//è®¡ç®—æ»‘å—å½“å‰ä½ç½®ï¼Œè®¡ç®—å½“å‰ç™¾åˆ†å°æ•°
				if(index == this.k){
          // æ’­æ”¾æ—¶ä¹Ÿç›‘å¬æ’­æ”¾çŠ¶æ€,å¦‚æœçŠ¶æ€å€¼ä¸ºpause å°±åœæ­¢æ’­æ”¾
          if(this.videoNewList[this.k].state == 'pause'){
            console.log('æŸ¥çœ‹æ’­æ”¾çŠ¶æ€',this.videoNewList[this.k].state)
            uni.createVideoContext(this.videoNewList[this.k]._id,this).pause();
          }
					// console.log(event)
					var currenttime = event.detail.currentTime
					this.timeNumber = Math.round(event.detail.duration)
					this.getTime()
					this.percent = currenttime/this.timeNumber
					this.currentPosition = this.windowWidth*this.percent
					let theTime = currenttime
					let middle = 0;// åˆ†
					if(theTime > 60) {
						middle = parseInt(theTime/60);
						theTime = parseInt(theTime%60);	
					}
					this.changeTime = `${Math.round(middle)>9?Math.round(middle):'0'+Math.round(middle)}:${Math.round(theTime)>9?Math.round(theTime):'0'+Math.round(theTime)}`
					//è‡ªåŠ¨åˆ‡æ¢è§†é¢‘
					if(this.isAutoplay){//true,ä»£è¡¨è‡ªåŠ¨æ’­æ”¾
						if(Math.round(currenttime) == this.timeNumber - 1){
							const dom = uni.requireNativePlugin('dom')
							let doms = 'item'+(this.k+1)
							setTimeout(()=>{
								let el = this.$refs[doms][0]
								dom.scrollToElement(el,{
									offset: 0,
									animated: true
								})
							},500)
						}
					}
				}
			},
			getTime(){//å¾—åˆ°æ—¶é—´å‡½æ•°
				this.videoTime = this.formatSeconds(this.timeNumber);
				// console.log(that.videoTime)
				var msg = []
				if(this.videoTime !== ''){
					msg = this.videoTime.split(':')
				}
				this.videoTimes = `${msg[0]>9?msg[0]:'0'+msg[0]}:${msg[1]>9?msg[1]:'0'+msg[1]}`;
			},
			formatSeconds(value) {//è·å–æ—¶é—´å‡½æ•°
				let theTime = parseInt(value);// ç§’
				let middle= 0;// åˆ†
				if(theTime > 60) {
					middle= parseInt(theTime/60);
					theTime = parseInt(theTime%60);	
				}
				return `${middle>9?middle:middle}:${theTime>9?theTime:theTime}`;
			},
			playIngs(index) {
				//
			},
			moreVideo(index){
				
			},
			toVideo(index){
				
			},
			erweima(){
				
			},

			stop(){
				// console.log('stop')
			},
			scrolls (event) {
				this.isDragging = event.isDragging
				if (!event.isDragging) {//isDraggingï¼šåˆ¤æ–­ç”¨æˆ·æ˜¯ä¸æ˜¯åœ¨æ»‘åŠ¨ï¼Œæ»‘åŠ¨ï¼štrueï¼Œåœæ­¢æ»‘åŠ¨ï¼šfalseã€‚æˆ‘ä»¬è¦ç”¨æˆ·åœæ­¢æ»‘åŠ¨æ—¶æ‰ç»™ k èµ‹å€¼ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¾ˆå¤šéº»çƒ¦
					var i = Math.round(Math.abs(event.contentOffset.y) / (this.wHeight - this.deleteHeight + 1))//å…ˆç”¨ç»å¯¹å€¼å–å‡ºæ»‘åŠ¨çš„è·ç¦»ï¼Œç„¶åé™¤ä»¥å±å¹•é«˜åº¦ï¼Œå–ä¸€ä¸ªæ•´ï¼Œå°±çŸ¥é“ä½ ç°åœ¨æ»‘åŠ¨åˆ°å“ªä¸€ä¸ªè§†é¢‘äº†
					if(i !== this.k){//è¿™é‡ŒåŠ åˆ¤æ–­æ˜¯å› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šæ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œä¼šé€ æˆé‡å¤è¯·æ±‚ï¼Œæ‰€ä»¥è¿™é‡Œå†™ä¸€ä¸ªé™åˆ¶
						if(uni.getSystemInfoSync().platform == 'ios'){
							this.k = i//åˆ¤æ–­äº†ç”¨æˆ·æ²¡æœ‰æ»‘åŠ¨ï¼Œç¡®è®¤äº†ç”¨æˆ·çš„ç¡®æ˜¯åœ¨çœ‹è¿™ä¸ªè§†é¢‘ï¼Œç„¶åå°±èµ‹å€¼å•¦
							this.videoNewList[this.k].state = 'play'
							console.log('æ­£åœ¨æ’­æ”¾ --> ç¬¬' + (this.k + 1) + 'ä¸ªè§†é¢‘ï½')
						} else {
							clearTimeout(this.timers);
							this.timers = setTimeout(()=>{
								this.k = i//åˆ¤æ–­äº†ç”¨æˆ·æ²¡æœ‰æ»‘åŠ¨ï¼Œç¡®è®¤äº†ç”¨æˆ·çš„ç¡®æ˜¯åœ¨çœ‹è¿™ä¸ªè§†é¢‘ï¼Œç„¶åå°±èµ‹å€¼å•¦
								this.videoNewList[this.k].state = 'play'
								console.log('æ­£åœ¨æ’­æ”¾ --> ç¬¬' + (this.k + 1) + 'ä¸ªè§†é¢‘ï½')
							},80)
						}
					}
				}
			},
      // è·å–æˆ‘çš„å…³æ³¨åˆ—è¡¨
      async getMyFollowList(){
        const res= await api.getFollowList({page:1});
        if(res.code == 1){
          if(res.data.data.length > 0){
            this.myFollowNum = res.data.data.length;
          }else{
            this.myFollowNum = 0;
          }
        }
      },
			async get(tabIdx){
				// è¿™ä¸ªæ–¹æ³•ä¸»è¦å°±æ˜¯ç”¨æ¥ç¬¬ä¸€æ¬¡è¿›å…¥è§†é¢‘æ’­æ”¾æ—¶ç”¨æ¥å¤„ç†çš„
				// this.dataList = userList;//è¿™ä¸ªå°±æ˜¯èµ‹å€¼åŠ è½½è§†é¢‘å•¦
        let data = {};
        let res = {};
        // æ¨èè§†é¢‘åˆ—è¡¨
        if(tabIdx == 0){
          data = {
            ...this.listQuery,
            lng:this.location.lng,
            lat:this.location.lat,
          }
          res = await api.videoList(data);
        }else if(tabIdx == 1){  //æˆ‘çš„å…³æ³¨è§†é¢‘åˆ—è¡¨
          data = {
            ...this.listQuery,
          }
          res = await api.myFollowVideoList(data);
        }
        if(res.code == 1){
          if(res.data.data.length > 0){
            let videoList = res.data.data;
            videoList.map((item,index)=>{
              this.$set(item,'isplay',true); //æ˜¯å¦æ’­æ”¾éŸ³é¢‘
              this.$set(item,'isShowProgressBarTime',false); //æ˜¯å¦æ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
              this.$set(item,'state','pause'); //åˆå§‹çŠ¶æ€æ ‡å¿—ï¼ˆä¸æ”¹ï¼‰
              this.$set(item,'isShowimage',false); //æ˜¯å¦æ˜¾ç¤ºå°é¢ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
              this.$set(item,'playIng',false); //æ’­æ”¾ï¼ˆé»˜è®¤è¿™ä¸ªå³å¯ï¼‰
            })
            this.videoNewList = videoList;
            // let url = 'http://vfx.mtime.cn/Video/2019/03/19/mp4/190319222227698228.mp4';
            // this.$set(this.videoNewList[0],'video_image_format',url)
            // var msg = res.data.data
            // console.log(msg)
            // this.dataList = this.videoNewList;
            this.videoNewList[0].state = "play";
            setTimeout(()=>{
              console.log('åˆ°äº†è¿™é‡Œ',this.videoNewList)
            	//è¿™é‡Œçš„å»¶è¿Ÿæ˜¯ä¸ºäº†é¿å…æ‰§è¡Œæ—¶é—´å¤ªå¿«è€Œç›´æ¥è·³è¿‡æ‰§è¡Œçš„ bug
            	uni.createVideoContext(this.videoNewList[0]._id,this).seek(0)
            	uni.createVideoContext(this.videoNewList[0]._id,this).play()
              // console.log('æ’­æ”¾äº†ç¬¬ä¸€ä¸ª',this.videoNewList[0].)
              this.handleAddFoot(this.videoNewList[0].id);
            },200)
            this.videoNewList[0].isplay = false
            setTimeout(()=>{
            	this.videoNewList[0].playIng = true
            },500)
            var p = 0
            setTimeout(()=>{
            	++p
            	uni.createVideoContext(this.videoNewList[p]._id,this).play()
            	setTimeout(()=>{
            		uni.createVideoContext(this.videoNewList[p]._id,this).seek(0)
            		uni.createVideoContext(this.videoNewList[p]._id,this).pause()
            		console.log('é¢„åŠ è½½ç¬¬' + (p + 1) + 'ä¸ªè§†é¢‘ï¼š' + this.videoNewList[p]._id)
            	},2000)
            },50)
            if(this.navbarTabIdx == tabIdx) return;
            this.navbarTabIdx = tabIdx;
          }
        }
				// uni.request({
				// 	url: 'https://bdb24c6d-8c19-4f80-8e7e-c9c9f037f131.bspapp.com/video',
				// 	method: 'POST',
				// 	data:{
				// 		info: 'get_video'
				// 	},
				// 	success: (res) => {
				// 		// console.log('è€æ•°æ®',res.data.data);
				// 	}
				// })
			},
      // æ·»åŠ è§†é¢‘åˆ°è¶³è¿¹
      async handleAddFoot(video_id){
        const res = await api.footprintStore({video_id});
        if(res.code == 1){
          console.log('æ·»åŠ æˆåŠŸ');
        }
      },
			onpullingdown(e){
        if(this.isRrshing) return;
				this.isRrshing = true;
				this.refreshing = true;
        // iosç›‘å¬ä¸åˆ°åˆ·æ–°ç»“æŸï¼Œæ‰€ä»¥æ‰§è¡Œä»¥ä¸‹æ–¹æ³•
        if(this.platform == 'ios'){
          uni.showLoading({
            mask:true,
            title:'è§†é¢‘åˆ·æ–°ä¸­Â·Â·Â·',
          })
          setTimeout(()=>{
            console.log('æ­£åœ¨ä¸‹æ‹‰åˆ·æ–°ï¼Œæ­¤æ—¶æ‰‹è¿˜åœ¨è§¦æ‘¸æ²¡æœ‰æ¾å¼€',e)
          	this.isRrshing = false;
            this.listQuery.page = 1;
            this.videoNewList = [];
            this.get(this.navbarTabIdx);
            uni.hideLoading();
          },1500)
        }
			},
			onrefresh(e){
				console.log('ä¸‹æ‹‰åˆ·æ–°å®Œæ¯•ï¼Œæ­¤æ—¶æ‰‹æ¾å¼€äº†',e)
				setTimeout(()=>{
					this.refreshing = false;
          this.listQuery.page = 1;
          this.videoNewList = [];
          this.get(this.navbarTabIdx);
				},1000)
			},
			// åŒå‡»ç‚¹èµæ•ˆæœ
			touchstartHover(event){
				if(this.touchNum >= 1){
					// console.log('åŒå‡» -- Xåæ ‡ï¼š'+ event.touches[0].screenX);
					// console.log('åŒå‡» -- Yåæ ‡ï¼š'+ event.touches[0].screenY);
					this.aixinLeft = event.touches[0].screenX - 50;
					this.aixinTop =  event.touches[0].screenY - 50;
					this.isShowAixin = true;
					let max = 40; let min = -40;
					this.Rotate = Math.floor(Math.random() * (max - min + 1)) + min;
					setTimeout(()=>{
						this.isShowAixin = false;
					},700)
					this.onTabItemTaps();
          this.cLike(this.videoNewList[this.k])
				}
			},
			//ç‚¹å‡»æ’­æ”¾&&æš‚åœ
			tapVideoHover(state,event){
        // å¦‚æœå°é¢ä¸éšè—ä¸èƒ½ç‚¹å‡»æš‚åœï¼Œæˆ–è€…æ’­æ”¾
        if(!this.videoNewList[this.k].playIng) return;
				this.videoNewList[this.k].isShowimage = false
				this.videoNewList[this.k].isShowProgressBarTime = false
				this.ProgressBarOpacity = 0.5
				this.dotWidth = 0
				console.log('state--',state);
				// 1.å¯ç”¨åŒå‡»ç‚¹èµ --- start
				this.touchNum++;
				setTimeout(()=>{
					if(this.touchNum == 1){
						if(state=='play'||state=='continue'){
							this.videoNewList[this.k].state = 'pause';
						}else{
							this.videoNewList[this.k].state = 'continue';
						}
						if(this.videoNewList[this.k].state == 'continue'){
							uni.createVideoContext(this.videoNewList[this.k]._id,this).play();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
						}
						if(this.videoNewList[this.k].state == 'pause'){
							uni.createVideoContext(this.videoNewList[this.k]._id,this).pause();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
						}
					}
					if(this.touchNum >= 2){
						// this.doubleLike();
					}
					this.touchNum = 0;
				},200)
				// --------------- ending
				// 2. ä¸å¯ç”¨åŒå‡»ç‚¹èµ start
				// if(state=='play'||state=='continue'){
				// 	this.dataList[this.k].state = 'pause';
				// }else{
				// 	this.dataList[this.k].state = 'continue';
				// }
				// if(this.dataList[this.k].state == 'continue'){
				// 	uni.createVideoContext(this.dataList[this.k]._id,this).play();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
				// }
				// if(this.dataList[this.k].state == 'pause'){
				// 	uni.createVideoContext(this.dataList[this.k]._id,this).pause();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
				// }
				// --------------- ending
			},
			doubleLike(){
				if(this.videoNewList[this.k].is_like == false){
					this.videoNewList[this.k].like += 1;
					this.videoNewList[this.k].is_like = true;
				}
				/*
				ç‚¹èµ
				*/
			},
			toComment(index){
				// æ³¨æ„ç‚¹å‡»è¯„è®ºä¹‹åä¼šæ‰§è¡Œè¿™é‡Œ
				/*
				ï¼ˆ1ï¼‰å…ˆåŠ è½½ç¼“å†²
				ï¼ˆ2ï¼‰è·å–å½“å‰è§†é¢‘ ID ä¿¡æ¯
				ï¼ˆ3ï¼‰ğŸŒŸğŸŒŸğŸŒŸğŸŒŸé‡è¦ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
					- ä¸€å®šè¦è®°å¾—çœ‹ index.vue é‡Œé¢
					 uni.setStorageSync("user",this.peopleList[i]);
					 è¿™ä¸ªä¸œè¥¿ï¼Œç”¨äºå­˜å‚¨å½“å‰ç”¨æˆ·ä¿¡æ¯ã€‚åœ¨ æ’ä»¶é‡Œé¢ä¼šä½¿ç”¨åˆ°è¿™ä¸ªä¸œè¥¿ï¼Œ
					 è®°å¾—å†™ä¸€ä¸‹ã€‚
					 
				ï¼ˆ4ï¼‰æ‰“å¼€è¯„è®º
				*/ 
        uni.showToast({
          title: 'åŠ è½½ä¸­...',
          icon: 'none',
          position: 'bottom',
          duration: 300
        })
        let user = this.videoNewList[index].user;
        this.$set(user,'id',this.videoNewList[index].user_id);
        uni.setStorageSync('user',user)
        console.log('okokokok',uni.getStorageSync('user'))
				uni.setStorageSync("videoID",this.videoNewList[index].id);
        // uni.setStorageSync("videoID",'60ee559d9dad850001bf5956');
				this.$refs.pinglun.open('bottom')
			},
      // æ‰“å¼€åˆ†äº«å¼¹çª—
			handleSharePopup(item){
        this.shareItem = Object.assign({},item);
        console.log('uuuu',this.shareItem);
        this.$refs.share.open('bottom')
				// uni.showToast({
				// 	title: 'åˆ†äº«',
				// 	icon: 'none'
				// })
			},
      // å…³é—­åˆ†äº«å¼¹çª—
      handleCloseSharePopup(){
        console.log('å…³é—­åˆ†äº«å¼¹çª—',)
        this.$refs.share.close();
        this.shareItem = {};
      },
			wxh5Video(){
				uni.navigateTo({
					url: '../wxh5previewVideo/wxh5previewVideo'
				})
			},
			previewVideo(){
				uni.navigateTo({
					url: '../previewVideo/previewVideo'
				})
			},
			toTwoVideo(){
				uni.navigateTo({
					url: '../new_index/new_index'
				})
			},
			tolistVideo(){
				uni.navigateTo({
					url: '../nvueSwiper/nvueSwiper'
				})
			},
      // å…³æ³¨è§†é¢‘ä½œè€…
      async handleAddUser(item){
        if(item.is_follow) return;
        const res = await api.followStore({follow_id:item.user_id});
        if(res.code == 1){
          uni.showToast({
            icon:'none',
            title:res.msg
          })
          item.is_follow = true;
          this.getMyFollowList();
        }
      },
      // ç‚¹èµï¼Œå–æ¶ˆç‚¹èµ
			async cLike(item){
        let data = {
          type:1, //è§†é¢‘ç‚¹èµ
          like_id:item.id,
        };
        let res = {};
        // å–æ¶ˆç‚¹èµ
          // console.log('ddddd',this.videoNewList[this.k].is_like)
        if(item.is_like){
          res = await api.subVideoLike(data);
          item.is_like = !item.is_like
        }else{
          // ç‚¹èµ
          res = await api.addVideoLike(data);
          item.is_like = !item.is_like
        }
        if(res.code == 1){
          uni.showToast({
            icon:'none',
            title:res.msg,
            duration:1500,
          })
          const video = item;
          item.is_like?video.like += 1:video.like -= 1;
          // this.videoNewList[this.k].is_like = !sss;
        }
				/*
				ç‚¹èµ
				*/
			},
      // æ”¶è—è§†é¢‘
      async handleFavorite(item){
        let data = {};
        let res = {};
        if(item.is_favorite){
          data = {
            favorite_ids:item.id,
          }
          res = await api.video_delFavorite(data);
          item.is_favorite = !item.is_favorite
        }else{
          data = {
            video_id:item.id,
          }
          res = await api.video_favoriteStore(data);
          item.is_favorite = !item.is_favorite
        }
        if(res.code == 1){
          uni.showToast({
            icon:'none',
            title:res.msg,
            duration:1500,
          })
          const video = item;
          item.is_favorite?video.favorite += 1:video.favorite -= 1;
          // this.videoNewList[this.k].is_like = !sss;
        }
      },
			moveHandle(){},
			closeScrollview(){
				// ç‚¹å‡»è¯„è®ºé‡Œé¢çš„å‰å‰ï¼Œå°±ä¼šå…³é—­è¯„è®º
				this.$refs.pinglun.close();
			},
			onTabItemTaps() {
			    // #ifdef APP-PLUS
			    if (uni.getSystemInfoSync().platform == "ios") {
			        let UIImpactFeedbackGenerator = plus.ios.importClass('UIImpactFeedbackGenerator');
			        let impact = new UIImpactFeedbackGenerator();
			        impact.prepare();
			        impact.init(1);
			        impact.impactOccurred();
			    }
			    if (uni.getSystemInfoSync().platform == "android") {
			        uni.vibrateShort({
			            success: () => {
			                console.log('ç‚¹å‡»éœ‡åŠ¨');
			            }
			        });
			    }
			    // #endif
			},
			handleChangeTabbar(path){
				uni.switchTab({
					url:path
				})
			},
      // ç‚¹å‡»åˆ†äº«å¼¹çª—æ¯é¡¹
      handleShareItem(index){
        let data = {};
        let encrypt = '';  //åŠ å¯†å­—ç¬¦ä¸²
        let decrypt = '';  //è§£å¯†å­—ç¬¦ä¸²
        let shareStr = '';
        switch(index){
          case 0: //å¾®ä¿¡
          case 1: //æœ‹å‹åœˆ
            data = {
              shareType:'video',
              shareId:this.userInfo.id,
              goodsId:this.shareItem.id,
            };
            encrypt = AES.AES.encrypt(JSON.stringify(data),'1234567891234567','1234567891234567');
            shareStr = 'å¯æ˜æ˜Ÿå›¾çŸ­è§†é¢‘åˆ†äº«ï¼Œå¤åˆ¶æ­¤é“¾æ¥åˆ°å¯æ˜æ˜Ÿå›¾Appï¼Œ' + this.shareItem.video_title + '#' + encrypt + '#'
            uni.setClipboardData({
            	data: shareStr,
            	success: () => { //å¤åˆ¶æˆåŠŸçš„å›è°ƒå‡½æ•°
                uni.showToast({
                  icon:'none',
                  title:'å¤åˆ¶åˆ†äº«é“¾æ¥æˆåŠŸï¼',
                  duration:2000,
                })
            	}
            });
            break;
          case 2: //ä¸‹è½½
            this.handleUploadVideo(this.shareItem.video_image_format)
            break;
          case 3: //ä¸¾æŠ¥
            let url = '/pages/videoShow/report/report?video_id=' + this.shareItem.id;
            uni.navigateTo({
              url:url,
            })
            break;
        }
      },
      // å…³é—­ä¸Šä¼ è§†é¢‘å¼¹çª—
      handleCloseVideoPopup(){
        this.$refs.video.close();
      },
      // ç‚¹å‡»è¿›å…¥è§†é¢‘ä½œè€…ä¸»é¡µ
      handleAhtuorInfo(user_id){
        uni.navigateTo({
          url:`/pages/mine/mineVideo/mineVideo?user_id=${user_id}&isAuthor=${user_id == this.userInfo.id}`,
        })
      },
      
      // ä¸‹è½½è§†é¢‘
      handleUploadVideo(url) {
          // æé†’ç”¨æˆ·ä¸‹è½½ä¸­
      	uni.showToast({title:"ä¸‹è½½ä¸­",icon:"loading"})
      	// 1 å°†è¿œç¨‹æ–‡ä»¶ä¸‹è½½åˆ°å°ç¨‹åºçš„å†…å­˜ä¸­
      	uni.downloadFile({
      	  url,
      		success: (res)=>{
      		  // 2 æˆåŠŸä¸‹è½½åè€Œä¸”çŠ¶æ€ç ä¸º200æ—¶å°†è§†é¢‘ä¿å­˜åˆ°æœ¬åœ°ç³»ç»Ÿ
      			if(res.statusCode === 200) {
      			  uni.saveVideoToPhotosAlbum({
                filePath: res.tempFilePath
              })
      			  uni.hideLoading();
      			  // æç¤ºç”¨æˆ·ä¸‹è½½æˆåŠŸ
      			  uni.showToast({title:"ä¸‹è½½æˆåŠŸ",icon:"success"});
      		  }
              // å¦‚æœè¯¥èµ„æºä¸å¯ä¸‹è½½æˆ–æ–‡ä»¶æ ¼å¼å‡ºé”™åˆ™æç¤ºç”¨æˆ·
              else {
      			    uni.showToast({title:"èµ„æºæ ¼å¼é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"});
              }
      	    },
      		fail: (err)=>{
      	    // ä¸‹è½½å¤±è´¥æé†’
      			uni.hideLoading();
      			uni.showToast({title:"ä¸‹è½½å¤±è´¥"})
      		}
      	})
      }
    }
  }
</script>
<style lang="scss" scoped>
  page{ 
    // padding-bottom: constant(safe-area-inset-bottom); 
    // padding-bottom: env(safe-area-inset-bottom); 
  }
</style>
<style>
	.container {background-color: #000000;}
 .video-navbar{
    position: fixed;
    padding-left: 30rpx;
    padding-right: 30rpx;
    display: flex;
    justify-content: space-between;
  }
  .select-video-type{
    /* overflow: hidden; */
    height: 150rpx;
    background: #fff;
    position: absolute;
    top: 70rpx;
    border-radius: 10rpx;
    padding: 10rpx 0;
    transition: height 0.3s;
    z-index: 99999;
  }
  .select-show-height{
    top: 70rpx !important;
    height: 150rpx !important;
  }
  .select-video-text{
    width: 200rpx;
    text-align: center;
  }
  .navbar-title{
    color: #fff;
  }
  .active-bold{
    font-weight: bold;
  }
  .not-active{
    width: 30rpx;
    height: 6rpx;
  }
  .bar-active{
    width: 30rpx;
    height: 6rpx;
    background: #fff;
  }
  .viode-top-icon{
    width: 30px;
    height: 30px;
  }
    .item {
		/* width : 750rpx; */
		background-color: #000000;
		position: relative;
	}
	.videoHover{
		position: absolute;
		top: 0;
		left: 0;
		flex: 1;
		background-color: rgba(0,0,0,0.1);
		justify-content: center;
		align-items: center;
		
		/* border-style: dashed;
		border-color: #DD524D;
		border-width: 1px; */
	}
	.playState{
		width:  160rpx;
		height: 160rpx;
		opacity: 0.2;
	}
	.userInfo{
		position: absolute;
		bottom:110px;
		right: 10px;
		flex-direction: column;
		
	}
	.userAvatar{
		border-radius: 500%;
		border-style: solid;
		border-width: 2px;
		border-color: #ffffff;
	}
	.userAvatar{
		width : 100rpx;
		height: 100rpx;
	}
  .user-avatar-body{
    position: relative;
    height: 120rpx;
  }
  .add-user-icon{
    width: 40rpx;
    height: 40rpx;
    position: absolute;
    bottom: 0rpx;
    left: 25%;
    transform: translateX(-50%);
    line-height: 38rpx;
    text-align: center;
    background: red;
    border-radius: 50%;
    color:#fff ;
  }
  .add-user-icon>image{
  }
	.likeIco,.shareIco,.commentIco{
		width : 60rpx;
		height: 60rpx;
		margin-top: 15px;
	}
	.likeNum,.commentNum,.shareTex{
		color: #ffffff;
		font-size: 30rpx;
		text-align: center;
		margin: 5px;
	}
	.likeNumActive{
		color: red;
	}
	.content{
	  width: 720rpx;
	  z-index: 99;
	  position: absolute;
	  bottom: 30px;
	  /* justify-content: center; */
	  padding: 15rpx;
	  flex-direction: column;
	  justify-content: flex-start;
	  color: #ffffff;
	}
	.userName {
	  font-size: 30rpx;
	  color: #ffffff;
	  margin-top: 80upx;
	}
	.words {
	  margin-top: 10rpx;
	  font-size: 30rpx;
	  color: #ffffff;
	}
	.root{
		background-color: #000000;
	}
  .share-bottom{
    border-top-left-radius: 20rpx;
    border-top-right-radius: 20rpx;
  }
  .share-row{
    padding:0 100rpx;
  }
  .share-img{
    display: flex;
    align-items: center;
  }
  .upload-video{
    background: #fff;
    border-top-left-radius: 20rpx;
    border-top-right-radius: 20rpx;
  }
  .upload-border{
    border-top: 1px solid #ccc;
    border-bottom: 1px solid #ccc;
  }
  .upload-item{
    text-align: center;
    align-items: center;
    padding: 20rpx 0;
  }
</style>
